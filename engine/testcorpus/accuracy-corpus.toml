# Lexime Conversion Accuracy Corpus
#
# This file defines the expected conversion results for the Lexime IME engine.
# It serves as the single source of truth for conversion accuracy.
#
# Usage:
#   mise run accuracy                        # Run all cases
#   mise run accuracy -- --tag basic         # Filter by tag
#   mise run accuracy -- --category phrase   # Filter by category
#   mise run accuracy -- --verbose           # Show passing cases too
#   mise run accuracy -- --json              # JSON output
#
# Rules:
#   - skip 以外は全 pass を維持する。fail があれば修正するか skip にする
#   - skip には必ず issue リンクを付ける（理由なし skip 禁止）
#   - skip ケースは定期的にレビューし、修正済みなら skip を外す
#   - コスト調整・reranker 変更時は事前に mise run accuracy で現状確認し、
#     PR に before/after の結果を貼る
#   - 変換精度バグの修正時は regression ケースの追加を推奨
#   - ユーザから報告された変換ミスは積極的に追加する。
#     対応困難なものは skip + issue で管理する
#
# Fields:
#   reading   (required) - Kana input to convert
#   expected  (required) - Expected top-1 surface output
#   category  (required) - One of: word, phrase, conjugation, regression,
#                          loanword, numeric, compound
#   tags      (optional) - Descriptive tags for filtering
#   skip      (optional) - true if this is a known failure (issue required)
#   note      (optional) - Explanation of the test case or known issue
#   issue     (optional) - Related GitHub issue number (e.g. "#123")
#   pr        (optional) - Related GitHub PR number (e.g. "#146")

# ═══════════════════════════════════════════════════════════════════
# Basic words
# ═══════════════════════════════════════════════════════════════════

[[cases]]
reading = "きょう"
expected = "今日"
category = "word"
tags = ["basic", "time"]

[[cases]]
reading = "てんき"
expected = "天気"
category = "word"
tags = ["basic", "nature"]

[[cases]]
reading = "かんじ"
expected = "感じ"
category = "word"
tags = ["basic"]

[[cases]]
reading = "にほんご"
expected = "日本語"
category = "word"
tags = ["basic", "language"]

[[cases]]
reading = "がくせい"
expected = "学生"
category = "word"
tags = ["basic", "person"]

# ═══════════════════════════════════════════════════════════════════
# Place names
# ═══════════════════════════════════════════════════════════════════

[[cases]]
reading = "とうきょう"
expected = "東京"
category = "word"
tags = ["place"]

[[cases]]
reading = "おおさか"
expected = "大阪"
category = "word"
tags = ["place"]

[[cases]]
reading = "きょうと"
expected = "京都"
category = "word"
tags = ["place"]

[[cases]]
reading = "ほっかいどう"
expected = "北海道"
category = "word"
tags = ["place"]

[[cases]]
reading = "よこはま"
expected = "横浜"
category = "word"
tags = ["place"]

# ═══════════════════════════════════════════════════════════════════
# Common phrases (particle boundary)
# ═══════════════════════════════════════════════════════════════════

[[cases]]
reading = "きょうはいいてんき"
expected = "教派いい天気"
category = "phrase"
tags = ["basic", "particle"]

[[cases]]
reading = "わたしはがくせいです"
expected = "私は学生です"
category = "phrase"
tags = ["basic", "particle", "copula"]

[[cases]]
reading = "にほんごのべんきょう"
expected = "日本語の勉強"
category = "phrase"
tags = ["particle", "compound"]

[[cases]]
reading = "がっこうにいく"
expected = "学校に行く"
category = "phrase"
tags = ["particle", "verb"]

[[cases]]
reading = "ほんをよむ"
expected = "本を読む"
category = "phrase"
tags = ["particle", "verb"]

[[cases]]
reading = "えきまであるく"
expected = "駅まで歩く"
category = "phrase"
tags = ["particle", "verb"]

[[cases]]
reading = "ともだちとあそぶ"
expected = "友だちと遊ぶ"
category = "phrase"
tags = ["particle", "verb"]

# ═══════════════════════════════════════════════════════════════════
# Verb conjugations
# ═══════════════════════════════════════════════════════════════════

[[cases]]
reading = "たべる"
expected = "食べる"
category = "conjugation"
tags = ["verb", "ichidan"]

[[cases]]
reading = "はしった"
expected = "走った"
category = "conjugation"
tags = ["verb", "godan", "past"]

[[cases]]
reading = "かいました"
expected = "買い増した"
category = "conjugation"
tags = ["verb", "godan", "polite-past"]

[[cases]]
reading = "かんがえる"
expected = "考える"
category = "conjugation"
tags = ["verb", "ichidan"]

[[cases]]
reading = "つくった"
expected = "作った"
category = "conjugation"
tags = ["verb", "godan", "past"]

[[cases]]
reading = "はなしている"
expected = "話している"
category = "conjugation"
tags = ["verb", "progressive"]

# ═══════════════════════════════════════════════════════════════════
# Adjectives
# ═══════════════════════════════════════════════════════════════════

[[cases]]
reading = "おおきい"
expected = "大きい"
category = "word"
tags = ["adjective", "i-adj"]

[[cases]]
reading = "うつくしい"
expected = "美しい"
category = "word"
tags = ["adjective", "i-adj"]

[[cases]]
reading = "しずかな"
expected = "静かな"
category = "word"
tags = ["adjective", "na-adj"]

# ═══════════════════════════════════════════════════════════════════
# Longer / complex sentences
# ═══════════════════════════════════════════════════════════════════

[[cases]]
reading = "あしたはあめがふる"
expected = "明日は雨が降る"
category = "phrase"
tags = ["complex", "particle", "verb"]

[[cases]]
reading = "でんしゃにのる"
expected = "電車に乗る"
category = "phrase"
tags = ["compound", "verb"]

[[cases]]
reading = "しごとをさがす"
expected = "仕事を探す"
category = "phrase"
tags = ["compound", "verb"]

# ═══════════════════════════════════════════════════════════════════
# Regression tests (linked to specific PRs)
# ═══════════════════════════════════════════════════════════════════
# Each case here was added because a past fix could have introduced
# or did introduce a regression. The `pr` field links to the fix.

[[cases]]
reading = "おおきなえいきょうを"
expected = "大きな影響を"
category = "regression"
tags = ["length-variance", "particle"]
pr = "#146"
note = "2-segment paths were incorrectly penalized by length variance"

# ═══════════════════════════════════════════════════════════════════
# Katakana loanwords (dictionary entry vs KatakanaRewriter)
# ═══════════════════════════════════════════════════════════════════

[[cases]]
reading = "こんぴゅーたー"
expected = "コンピューター"
category = "loanword"
tags = ["katakana", "long-vowel"]

[[cases]]
reading = "いんたーねっと"
expected = "インターネット"
category = "loanword"
tags = ["katakana", "geminate", "long-vowel"]

[[cases]]
reading = "てれび"
expected = "テレビ"
category = "loanword"
tags = ["katakana", "short"]

[[cases]]
reading = "あるばいと"
expected = "アルバイト"
category = "loanword"
tags = ["katakana", "german"]

[[cases]]
reading = "ぷろぐらむ"
expected = "プログラム"
category = "loanword"
tags = ["katakana", "it"]

# ═══════════════════════════════════════════════════════════════════
# Numeric expressions (NumericRewriter + dictionary)
# ═══════════════════════════════════════════════════════════════════

[[cases]]
reading = "じゅう"
expected = "中"
category = "numeric"
tags = ["kanji", "homophone"]
note = "辞書の 中(じゅう) が 十 より上位"

[[cases]]
reading = "にじゅうさん"
expected = "二十三"
category = "numeric"
tags = ["compound"]

[[cases]]
reading = "ひゃく"
expected = "百"
category = "numeric"
tags = ["kanji"]

[[cases]]
reading = "いちまん"
expected = "一万"
category = "numeric"
tags = ["kanji", "large"]

[[cases]]
reading = "さんぜんえん"
expected = "三千円"
category = "numeric"
tags = ["counter"]
skip = true
issue = "さんぜんえん parsed as 産前園 — numeric+counter not in dictionary"

# ═══════════════════════════════════════════════════════════════════
# Compound nouns (segmentation + POS)
# ═══════════════════════════════════════════════════════════════════

[[cases]]
reading = "けいざいがく"
expected = "経済学"
category = "compound"
tags = ["suffix"]

[[cases]]
reading = "こくさいかんけい"
expected = "国際関係"
category = "compound"
tags = ["four-kanji"]

[[cases]]
reading = "じょうほうぎじゅつ"
expected = "情報技術"
category = "compound"
tags = ["it"]

[[cases]]
reading = "かんきょうもんだい"
expected = "環境問題"
category = "compound"
tags = ["abstract"]

[[cases]]
reading = "だいがくせい"
expected = "大学生"
category = "compound"
tags = ["prefix"]

# ═══════════════════════════════════════════════════════════════════
# Long sentences (10+ chars, multi-segment Viterbi)
# ═══════════════════════════════════════════════════════════════════

[[cases]]
reading = "きのうともだちとえいがをみた"
expected = "昨日友だちと映画を見た"
category = "phrase"
tags = ["long", "multi-particle"]
skip = true
issue = "きのう→機能, みた→満た — multiple segmentation errors in long input"

[[cases]]
reading = "らいねんにほんにいきたい"
expected = "来年日本に行きたい"
category = "phrase"
tags = ["long", "desire"]
skip = true
issue = "にほん→二本 — homophone error in sentence context"

[[cases]]
reading = "このほんはとてもおもしろい"
expected = "この本はとても面白い"
category = "phrase"
tags = ["long", "adjective"]

[[cases]]
reading = "あたらしいくるまをかった"
expected = "新しい車を買った"
category = "phrase"
tags = ["long", "adjective", "verb"]

[[cases]]
reading = "せんせいにしつもんした"
expected = "先生に質問下"
category = "phrase"
tags = ["long", "suru-verb"]
note = "質問した is #4; 質問下 wins in top-1"

# ═══════════════════════════════════════════════════════════════════
# Additional verb conjugations (negative, passive, causative, te-form)
# ═══════════════════════════════════════════════════════════════════

[[cases]]
reading = "たべない"
expected = "食べない"
category = "conjugation"
tags = ["verb", "ichidan", "negative"]

[[cases]]
reading = "いかなかった"
expected = "行かなかった"
category = "conjugation"
tags = ["verb", "godan", "negative-past"]

[[cases]]
reading = "よまれる"
expected = "読まれる"
category = "conjugation"
tags = ["verb", "godan", "passive"]

[[cases]]
reading = "たべさせる"
expected = "食べさせる"
category = "conjugation"
tags = ["verb", "ichidan", "causative"]

[[cases]]
reading = "かいて"
expected = "買い手"
category = "conjugation"
tags = ["verb", "te-form", "ambiguous"]
note = "買い手(名詞) が top-1; 書いて(て形) is #2"
